<!DOCTYPE html>
<html>
<head>
  <title>Vocabulary</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 90vh;
      font-size: 70px;
      color: #333;
      font-weight: 500;
      text-align: center;
      position: relative;
    }

    #delayInput {
      position: absolute;
      bottom: 5px;
      right: 20px;
      font-size: 14px;
      text-align: center;
      padding: 4px;
      width: 80px;
      height: 26px;
      border: none;
    }

    #lineWrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 90%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    #lineNumber {
      font-size: 12px;
      position: absolute;
      bottom: 5px;
      left: 20px;
    }
  </style>
</head>
<body>
  <div id="lineWrapper"><span id="line"></span></div>
  <span id="lineNumber"></span>

  <!-- Delay dropdown -->
  <select id="delayInput" title="Delay in seconds">
    <option value="2">2</option>
    <option value="6">6</option>
    <option value="8">8</option>
    <option value="100000" selected>100000</option>
  </select>

  <script>
    const text = `
a 1
a mountain of, a mountain of problems, a mountain of paperwork
a step closer, one step closer
a truckload of, a truckload of work
abandon, abandoned
above all
abrupt, abruptly, abrupt ending, ended abruptly, abrupt, abruptly, abrupt ending, ended abruptly
absolute gold, presentation was absolute gold
absolute joy, absolute joy to be around
absolutely, absolutely right
abstract
`;

    const lines = text.split(/\r?\n/).filter(x => x.trim());

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    const shuffled = shuffle([...lines]);
    const lineDisplay = document.getElementById("line");
    const lineNumberDisplay = document.getElementById("lineNumber");
    const delayInput = document.getElementById("delayInput");

    let index = 0;
    let interval = null;

    function getDelay() {
      const val = parseInt(delayInput.value);
      return isNaN(val) || val < 1 ? 10 : val;
    }

    function showLine() {
      if (index >= 0 && index < shuffled.length) {
        const line = shuffled[index];
        lineDisplay.textContent = line;
        lineNumberDisplay.textContent = `${index + 1}`;
        document.title = line;
      }
    }

    function start() {
      if (!interval && index < shuffled.length) {
        interval = setInterval(() => {
          index++;
          if (index < shuffled.length) {
            showLine();
          } else {
            clearInterval(interval);
            interval = null;
          }
        }, getDelay() * 1000);
      }
    }

    delayInput.addEventListener("change", () => {
      if (interval) {
        clearInterval(interval);
        interval = null;
        start();
      }
    });

    function prevLine() {
      if (index > 0) {
        index--;
        showLine();
      }
    }

    function nextLine() {
      if (index < shuffled.length - 1) {
        index++;
        showLine();
      }
    }

    document.addEventListener("keydown", e => {
      if (e.code === "ArrowLeft" || e.code === "PageUp") prevLine();
      else if (e.code === "ArrowRight" || e.code === "PageDown") nextLine();
    });

    // Tap support: right half → next line, left half → previous line
    document.addEventListener("touchend", e => {
      const touchX = e.changedTouches[0].clientX;
      const screenWidth = window.innerWidth;

      if (touchX > screenWidth / 2) {
        nextLine();
      } else {
        prevLine();
      }
    });

    // Initial load
    showLine();
    start();
  </script>
</body>
</html>
