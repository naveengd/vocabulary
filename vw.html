<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vocabulary Words</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0 50px;
        background-color: #ffffff;
        color: #000000;
        padding-top: 60px;
    }
    #filterBar {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #ffffff;
        border-bottom: 1px solid #eee;
        padding: 10px 0;
        text-align: center;
        z-index: 1000;
    }
    #wordCount { margin-right: 15px; }
    .filter-letter {
        display: inline-block;
        margin: 0 5px;
        padding: 5px 10px;
        border: 1px solid #eee;
        border-radius: 4px;
        cursor: pointer;
        color: #000000;
        text-transform: lowercase;
    }
    .filter-letter.active { background-color: gray; color: #fff; }
    #toggleExamples {
        padding: 5px 12px;
        border: 1px solid #eee;
        border-radius: 4px;
        cursor: pointer;
        background-color: #f8f8f8;
    }
    #wordList { list-style-type: none; padding: 0 20px; }
    .word-item {
        font-weight: 500;
        font-size: 1.2rem;
        margin-top: 20px;
        color: #333333;
        cursor: pointer;
    }
    .example-item {
        margin-left: 20px;
        margin-top: 15px;
        font-size: 1.1rem;
        color: #888888;
        display: none; /* Hidden by default */
    }
    .word-number { font-size: 0.5em; color: gray; margin-left: 8px; }
</style>
</head>
<body>
<div id="filterBar">
    <span id="wordCount">0</span>
    <button id="toggleExamples">Show</button>
</div>
<ul id="wordList"></ul>
<script>
const filterBar = document.getElementById('filterBar');
const wordListElement = document.getElementById('wordList');
const wordCountElem = document.getElementById('wordCount');
const toggleBtn = document.getElementById('toggleExamples');

let allWords = [];
let examplesVisible = false; // default hidden
let allExampleItems = [];    // cache all example elements
let wordElements = [];       // cache word <li> for filtering

// Create filter letters a-z
for(let i = 97; i <= 122; i++) {
    const letter = String.fromCharCode(i);
    const letterElem = document.createElement('span');
    letterElem.textContent = letter;
    letterElem.classList.add('filter-letter');
    letterElem.addEventListener('click', () => filterWords(letter, letterElem));
    filterBar.appendChild(letterElem);
}

// Fetch words from GitHub
fetch('https://naveengd.github.io/vocabulary/words.txt')
    .then(response => response.text())
    .then(data => {
        const lines = data.split('\n');
        lines.forEach(line => {
            const parts = line.split('.').map(p => p.trim()).filter(p => p !== '');
            if(parts.length === 0) return;
            allWords.push({ word: parts[0], examples: parts.slice(1) });
        });
        renderAllWords();
        wordCountElem.textContent = allWords.length;
    })
    .catch(err => {
        console.error('Error fetching words:', err);
        wordListElement.innerHTML = '<li>Failed to load words. Please try again later.</li>';
    });

function renderAllWords() {
    wordListElement.innerHTML = '';
    allExampleItems = [];
    wordElements = [];

    allWords.forEach((item, index) => {
        // Word item
        const wordItem = document.createElement('li');
        wordItem.classList.add('word-item');
        wordItem.textContent = item.word;

        // Number
        const numberSpan = document.createElement('span');
        numberSpan.textContent = ` ${index + 1}`;
        numberSpan.classList.add('word-number');
        wordItem.appendChild(numberSpan);

        wordListElement.appendChild(wordItem);
        wordElements.push({ element: wordItem, word: item.word.toLowerCase() });

        // Examples
        const exampleItems = [];
        item.examples.forEach(example => {
            const exampleItem = document.createElement('li');
            exampleItem.textContent = example;
            exampleItem.classList.add('example-item');
            exampleItem.style.display = examplesVisible ? 'list-item' : 'none';
            wordListElement.appendChild(exampleItem);

            exampleItems.push(exampleItem);
            allExampleItems.push(exampleItem);
        });

        // Toggle individual word examples
        wordItem.addEventListener('click', () => {
            exampleItems.forEach(ex => {
                ex.style.display = ex.style.display === 'none' ? 'list-item' : 'none';
            });
        });
    });

    toggleBtn.textContent = examplesVisible ? 'Hide' : 'Show';
}

// Global toggle for all examples
toggleBtn.addEventListener('click', () => {
    examplesVisible = !examplesVisible;
    allExampleItems.forEach(ex => {
        ex.style.display = examplesVisible ? 'list-item' : 'none';
    });
    toggleBtn.textContent = examplesVisible ? 'Hide' : 'Show';
});

// Filter without rebuilding DOM
function filterWords(letter, clickedElem) {
    document.querySelectorAll('.filter-letter').forEach(elem => elem.classList.remove('active'));
    clickedElem.classList.add('active');

    let visibleCount = 0;
    wordElements.forEach(({ element, word }) => {
        const matches = word.startsWith(letter);
        element.style.display = matches ? 'list-item' : 'none';

        // hide/show that wordâ€™s examples too
        let next = element.nextSibling;
        while (next && next.classList.contains('example-item')) {
            next.style.display = matches && examplesVisible ? 'list-item' : 'none';
            next = next.nextSibling;
        }

        if (matches) visibleCount++;
    });

    wordCountElem.textContent = visibleCount;
    window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
</body>
</html>
